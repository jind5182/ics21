HW2

2.88

line 1:A 1 01110 001  -9/16       B 1 0110 0010  -9/16

line 2:A 0 10110 101  13*(2^4)    B 0 1110 1010  13*(2^4)

line 3:A 1 00111 110  -7/(2^10)   B 1 0000 0111  -7/(2^10)

line 4:A 0 00000 101  5/(2^17)    B 0 0000 0001  1/(2^10)

line 5:A 1 11011 000  -2^12       B 1 1110 1111  -31*(2^3)

line 6:A 0 11000 100  3*(2^8)     B 0 1111 0000  +∞

2.92
float_bits float_negate(float_bits f)
{

    if ((f & 0x7F800000) == 0x7F800000);
      return f;
    return f ^ 0x80000000;
    
}

2.96

int float_f2i(float_bits f)// int [-2^31,2^31-1]
{

    unsigned sign = f >> 31;
    unsigned exp = (f >> 23) & 0xFF;
    unsigned frac = f & 0x7FFFFF;
    unsigned bias = 127;
    
    int res;
    unsigned E;
    unsigned M;
    
    if (exp >= 31 + bias) // 数太大超范围，或为TMin
        res = 0x80000000;
        
    else if (exp < 0 + bias) // exp>0即使是1.111...除以2也小于1;exp=0显然
        res = 0;//下面考虑exp在[bias,30+bias]
        
    else // >=1且能用int表示
    {
        E = exp-bias; // E在[0,30];
        M = frac | 800000;
        
        if (E >= 23) // 精确表示
          res = M << (E - 23);  
        else
          res = M >> (23 - E); // 向0舍入
    }
    
    return (sign? -res : res);
}
